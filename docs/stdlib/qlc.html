<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.21.2">
    <meta name="project" content="stdlib v22.1.4">
    <title>qlc — stdlib v22.1.4</title>
    <link rel="stylesheet" href="dist/html-de2388dc2f8074b0a4db.css" />
    <script src="dist/sidebar_items-db767c5cd4.js"></script>
      <script src="docs_config.js"></script>
    <script async src="dist/html-de2388dc2f8074b0a4db.js"></script>
  </head>
  <body data-type="modules">
    <script>try { if(localStorage.getItem('night-mode') === 'true') document.body.className += ' night-mode'; } catch (e) { }</script>
<div class="main">

<button class="sidebar-button sidebar-toggle">
  <span class="icon-menu" title="Collapse/expand sidebar"></span>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button">
      <span class="icon-search" aria-hidden="true"></span>
    </button>
    <button type="button" tabindex="-1" class="search-close-button">
      <span class="icon-cross" title="Cancel search"></span>
    </button>
    <label class="search-label">
      <input name="q" type="text" id="search-list" class="search-input" placeholder="Search..." aria-label="Search" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">
    <div class="sidebar-projectDetails">
      <a href="array.html" class="sidebar-projectName">
stdlib      </a>
      <h2 class="sidebar-projectVersion">
        v22.1.4
      </h2>
    </div>
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

      <li><a id="modules-list" href="#full-list">Modules</a></li>


  </ul>
  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <div class="content-outer">
    <div id="content" class="content-inner">

      <h1>
        <small class="app-vsn">stdlib v22.1.4</small>
qlc      </h1>


        <section id="moduledoc">
<p> This module provides a query interface to Mnesia, ETS, Dets, and other data structures that provide an iterator style traversal of objects.</p>
        </section>

        <section id="summary" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#summary">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
            Summary
          </h1>
  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#append/1">append/1</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle. When evaluating query handle <code class="inline">QH</code>, all answers to the first query handle in <code class="inline">QHL</code> are returned, followed by all answers to the remaining query handles in <code class="inline">QHL</code>.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#append/2">append/2</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle. When evaluating query handle <code class="inline">QH3</code>, all answers to <code class="inline">QH1</code> are returned, followed by all answers to <code class="inline">QH2</code>.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#cursorcursor/12">cursorcursor/12</a>
  </div>
    <div class="summary-synopsis"><p> Creates a query cursor and makes the calling process the owner of the cursor. The cursor is to be used as argument to  <code class="inline">next_answers/1,2</code> and (eventually) <a href="#delete_cursor/1"><code class="inline">delete_cursor/1</code></a>. Calls  <code class="inline">erlang:spawn_opt/2</code> to spawn and link to a process that evaluates the query handle. The value of option <code class="inline">spawn_options</code> is used as last argument when calling <code class="inline">spawn_opt/2</code>. Defaults to <code class="inline">[link]</code>.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#delete_cursor/1">delete_cursor/1</a>
  </div>
    <div class="summary-synopsis"><p> Deletes a query cursor. Only the owner of the cursor can delete the cursor.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#eeevaleval/1212">eeevaleval/1212</a>
  </div>
    <div class="summary-synopsis"><p> Evaluates a query handle in the calling process and collects all answers in a list.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#foldfold/34">foldfold/34</a>
  </div>
    <div class="summary-synopsis"><p> Calls <a href="https://hexdocs.pm/elixir/Function.html"><code class="inline">Function</code></a> on successive answers to the query handle together with an extra argument <code class="inline">AccIn</code>. The query handle and the function are evaluated in the calling process. <a href="https://hexdocs.pm/elixir/Function.html"><code class="inline">Function</code></a> must return a new accumulator, which is passed to the next call. <code class="inline">Acc0</code> is returned if there are no answers to the query handle.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#format_error/1">format_error/1</a>
  </div>
    <div class="summary-synopsis"><p> Returns a descriptive string in English of an error tuple returned by some of the functions of the <code class="inline">qlc</code> module or the parse transform. This function is mainly used by the compiler invoking the parse transform.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#infoinfo/12">infoinfo/12</a>
  </div>
    <div class="summary-synopsis"><p> Returns information about a query handle. The information describes the simplifications and optimizations that are the results of preparing the query for evaluation. This function is probably mainly useful during debugging.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#keysortkeysort/23">keysortkeysort/23</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle. When evaluating query handle <code class="inline">QH2</code>, the answers to query handle <code class="inline">QH1</code> are sorted by <code class="inline">file_sorter:keysort/4</code> according to the options.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#next_answersnext_answers/12">next_answersnext_answers/12</a>
  </div>
    <div class="summary-synopsis"><p> Returns some or all of the remaining answers to a query cursor. Only the owner of <code class="inline">QueryCursor</code> can retrieve answers.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#qq/12">qq/12</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle for a QLC. The QLC must be the first argument to this function, otherwise it is evaluated as an ordinary list comprehension. It is also necessary to add the following line to the source code</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#sortsort/12">sortsort/12</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle. When evaluating query handle <code class="inline">QH2</code>, the answers to query handle <code class="inline">QH1</code> are sorted by <code class="inline">file_sorter:sort/3</code> according to the options.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#string_to_handlestring_to_handlestring_to_handle/123">string_to_handlestring_to_handlestring_to_handle/123</a>
  </div>
    <div class="summary-synopsis"><p> A string version of <code class="inline">q/1,2</code>. When the query handle is evaluated, the fun created by the parse transform is interpreted by <code class="inline">erl_eval(3)</code>. The query string is to be one single QLC terminated by a period.</p></div>
</div>
<div class="summary-row">
  <div class="summary-signature">
    <a href="#table/2">table/2</a>
  </div>
    <div class="summary-synopsis"><p> Returns a query handle for a QLC table. In Erlang/OTP there is support for ETS, Dets, and Mnesia tables, but many other data structures can be turned into QLC tables. This is accomplished by letting function(s) in the module implementing the data structure create a query handle by calling <code class="inline">qlc:table/2</code>. The different ways to traverse the table and properties of the table are handled by callback functions provided as options to <code class="inline">qlc:table/2</code>.</p></div>
</div>
  </div>
        </section>

        <section id="functions" class="details-list">
          <h1 class="section-heading">
            <a class="hover-link" href="#functions">
              <span class="icon-link" aria-hidden="true"></span>
              <span class="sr-only">Link to this section</span>
            </a>
Functions          </h1>
          <div class="functions-list">
<section class="detail" id="append/1">
  <div class="detail-header">
    <a href="#append/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">append/1</h1>
      <div class="specs">
          <pre>append(qHL) :: qH when qHL: [query_handle_or_list()], qH: query_handle()</pre>
      </div>
  </div>
  <section class="docstring">
<p> Returns a query handle. When evaluating query handle <code class="inline">QH</code>, all answers to the first query handle in <code class="inline">QHL</code> are returned, followed by all answers to the remaining query handles in <code class="inline">QHL</code>.</p>
  </section>
</section>
<section class="detail" id="append/2">
  <div class="detail-header">
    <a href="#append/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">append/2</h1>
      <div class="specs">
          <pre>append(qH1, qH2) :: qH3
when qH1: query_handle_or_list(),
     qH2: query_handle_or_list(),
     qH3: query_handle()</pre>
      </div>
  </div>
  <section class="docstring">
<p> Returns a query handle. When evaluating query handle <code class="inline">QH3</code>, all answers to <code class="inline">QH1</code> are returned, followed by all answers to <code class="inline">QH2</code>.</p>
<p> <code class="inline">append(QH1, QH2)</code> is equivalent to <code class="inline">append([QH1, QH2])</code>.</p>
  </section>
</section>
<section class="detail" id="cursorcursor/12">
  <div class="detail-header">
    <a href="#cursorcursor/12" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">cursorcursor/12</h1>
  </div>
  <section class="docstring">
<p> Creates a query cursor and makes the calling process the owner of the cursor. The cursor is to be used as argument to  <code class="inline">next_answers/1,2</code> and (eventually) <a href="#delete_cursor/1"><code class="inline">delete_cursor/1</code></a>. Calls  <code class="inline">erlang:spawn_opt/2</code> to spawn and link to a process that evaluates the query handle. The value of option <code class="inline">spawn_options</code> is used as last argument when calling <code class="inline">spawn_opt/2</code>. Defaults to <code class="inline">[link]</code>.</p>
<p> Example:</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="9474883808-1">(</span><span class="p" data-group-id="9474883808-2">[</span><span class="p" data-group-id="9474883808-3">{</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="9474883808-3">}</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="9474883808-4">[</span><span class="ss">a</span><span class="p">,</span><span class="ss">b</span><span class="p" data-group-id="9474883808-4">]</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="9474883808-5">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="9474883808-5">]</span><span class="p" data-group-id="9474883808-2">]</span><span class="p" data-group-id="9474883808-1">)</span><span class="p">,</span><span class="w">
</span><span class="n">QC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">cursor</span><span class="p" data-group-id="9474883808-6">(</span><span class="n">QH</span><span class="p" data-group-id="9474883808-6">)</span><span class="p">,</span><span class="w">
</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">next_answers</span><span class="p" data-group-id="9474883808-7">(</span><span class="n">QC</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9474883808-7">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9474883808-8">[</span><span class="p" data-group-id="9474883808-9">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="9474883808-9">}</span><span class="p" data-group-id="9474883808-8">]</span><span class="w">
</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">next_answers</span><span class="p" data-group-id="9474883808-10">(</span><span class="n">QC</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9474883808-10">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9474883808-11">[</span><span class="p" data-group-id="9474883808-12">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="9474883808-12">}</span><span class="p" data-group-id="9474883808-11">]</span><span class="w">
</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">next_answers</span><span class="p" data-group-id="9474883808-13">(</span><span class="n">QC</span><span class="p">,</span><span class="w"> </span><span class="ss">all_remaining</span><span class="p" data-group-id="9474883808-13">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="9474883808-14">[</span><span class="p" data-group-id="9474883808-15">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="9474883808-15">}</span><span class="p">,</span><span class="p" data-group-id="9474883808-16">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="9474883808-16">}</span><span class="p" data-group-id="9474883808-14">]</span><span class="w">
</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">delete_cursor</span><span class="p" data-group-id="9474883808-17">(</span><span class="n">QC</span><span class="p" data-group-id="9474883808-17">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span></code></pre>
<p> <code class="inline">cursor(``QH``)</code> is equivalent to <code class="inline">cursor(``QH``, [])</code>.</p>
  </section>
</section>
<section class="detail" id="delete_cursor/1">
  <div class="detail-header">
    <a href="#delete_cursor/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">delete_cursor/1</h1>
      <div class="specs">
          <pre>delete_cursor(queryCursor) :: :ok when queryCursor: query_cursor()</pre>
      </div>
  </div>
  <section class="docstring">
<p> Deletes a query cursor. Only the owner of the cursor can delete the cursor.</p>
  </section>
</section>
<section class="detail" id="eeevaleval/1212">
  <div class="detail-header">
    <a href="#eeevaleval/1212" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">eeevaleval/1212</h1>
  </div>
  <section class="docstring">
<p> Evaluates a query handle in the calling process and collects all answers in a list.</p>
<p> Example:</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="7455232707-1">(</span><span class="p" data-group-id="7455232707-2">[</span><span class="p" data-group-id="7455232707-3">{</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="7455232707-3">}</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7455232707-4">[</span><span class="ss">a</span><span class="p">,</span><span class="ss">b</span><span class="p" data-group-id="7455232707-4">]</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7455232707-5">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="7455232707-5">]</span><span class="p" data-group-id="7455232707-2">]</span><span class="p" data-group-id="7455232707-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">eval</span><span class="p" data-group-id="7455232707-6">(</span><span class="n">QH</span><span class="p" data-group-id="7455232707-6">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="7455232707-7">[</span><span class="p" data-group-id="7455232707-8">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="7455232707-8">}</span><span class="p">,</span><span class="p" data-group-id="7455232707-9">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="7455232707-9">}</span><span class="p">,</span><span class="p" data-group-id="7455232707-10">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="7455232707-10">}</span><span class="p">,</span><span class="p" data-group-id="7455232707-11">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="7455232707-11">}</span><span class="p" data-group-id="7455232707-7">]</span></code></pre>
<p> <code class="inline">eval(``QH``)</code> is equivalent to <code class="inline">eval(``QH``, [])</code>.</p>
  </section>
</section>
<section class="detail" id="foldfold/34">
  <div class="detail-header">
    <a href="#foldfold/34" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">foldfold/34</h1>
  </div>
  <section class="docstring">
<p> Calls <a href="https://hexdocs.pm/elixir/Function.html"><code class="inline">Function</code></a> on successive answers to the query handle together with an extra argument <code class="inline">AccIn</code>. The query handle and the function are evaluated in the calling process. <a href="https://hexdocs.pm/elixir/Function.html"><code class="inline">Function</code></a> must return a new accumulator, which is passed to the next call. <code class="inline">Acc0</code> is returned if there are no answers to the query handle.</p>
<p> Example:</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="9314880703-1">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p" data-group-id="9314880703-1">]</span><span class="p">,</span><span class="w">
</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">fold</span><span class="p" data-group-id="9314880703-2">(</span><span class="nf">fun</span><span class="p" data-group-id="9314880703-3">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Sum</span><span class="p" data-group-id="9314880703-3">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Sum</span><span class="w"> </span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">QH</span><span class="p" data-group-id="9314880703-2">)</span><span class="p">.</span><span class="w">
</span><span class="mi">21</span></code></pre>
<p> <code class="inline">fold(``Function``, ``Acc0``, ``QH``)</code> is equivalent to <code class="inline">fold(``Function``, ``Acc0``, ``QH``, [])</code>.</p>
  </section>
</section>
<section class="detail" id="format_error/1">
  <div class="detail-header">
    <a href="#format_error/1" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">format_error/1</h1>
      <div class="specs">
          <pre>format_error(error) :: chars
when error: {:error, <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">module</a>(), <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()}, chars: <a href=":io_lib.html#t:chars/0">:io_lib.chars</a>()</pre>
      </div>
  </div>
  <section class="docstring">
<p> Returns a descriptive string in English of an error tuple returned by some of the functions of the <code class="inline">qlc</code> module or the parse transform. This function is mainly used by the compiler invoking the parse transform.</p>
  </section>
</section>
<section class="detail" id="infoinfo/12">
  <div class="detail-header">
    <a href="#infoinfo/12" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">infoinfo/12</h1>
  </div>
  <section class="docstring">
<p> Returns information about a query handle. The information describes the simplifications and optimizations that are the results of preparing the query for evaluation. This function is probably mainly useful during debugging.</p>
<p> The information has the form of an Erlang expression where QLCs most likely occur. Depending on the format functions of mentioned QLC tables, it is not certain that the information is absolutely accurate.</p>
<p> Options:</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">sequence</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">QLCs</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">block</span><span class="p">,</span><span class="w"> </span><span class="ss">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="8319798892-1">{</span><span class="ss">flat</span><span class="p">,</span><span class="err"> </span><span class="ss">false</span><span class="p" data-group-id="8319798892-1">}</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">specified</span><span class="p">,</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="ss">single</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">returned</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">string</span><span class="p">,</span><span class="w"> </span><span class="ss">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="8319798892-2">{</span><span class="ss">format</span><span class="p">,</span><span class="err"> </span><span class="ss">abstract_code</span><span class="p" data-group-id="8319798892-2">}</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">specified</span><span class="p">,</span><span class="w"> </span><span class="ss">abstract</span><span class="w"> </span><span class="ss">code</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">returned</span><span class="w"> </span><span class="ss">instead</span><span class="p">.</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">abstract</span><span class="w"> </span><span class="ss">code</span><span class="p">,</span><span class="w"> </span><span class="ss">port</span><span class="w"> </span><span class="ss">identifiers</span><span class="p">,</span><span class="w"> </span><span class="ss">references</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">pids</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">represented</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="ss">strings</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">elements</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">lists</span><span class="p">,</span><span class="w"> </span><span class="ss">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="8319798892-3">{</span><span class="ss">n_elements</span><span class="p">,</span><span class="err"> </span><span class="n">NElements</span><span class="p" data-group-id="8319798892-3">}</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">specified</span><span class="p">,</span><span class="w"> </span><span class="ss">only</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">limited</span><span class="w"> </span><span class="ss">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">elements</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">returned</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">show</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">parts</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specifications</span><span class="p">,</span><span class="w"> </span><span class="ss">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="8319798892-4">{</span><span class="ss">depth</span><span class="p">,</span><span class="err"> </span><span class="n">Depth</span><span class="p" data-group-id="8319798892-4">}</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">specified</span><span class="p">,</span><span class="w"> </span><span class="ss">parts</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">terms</span><span class="w"> </span><span class="ss">below</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">certain</span><span class="w"> </span><span class="ss">depth</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">replaced</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="err">`</span><span class="ss">&#39;...&#39;</span><span class="err">`</span><span class="p">.</span></code></pre>
<p>   <code class="inline">info(``QH``)</code> is equivalent to <code class="inline">info(``QH``, [])</code>.</p>
<p> Examples:</p>
<p> In the following example two simple QLCs are inserted only to hold option <code class="inline">{unique, true}</code>:</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="7311727822-1">(</span><span class="p" data-group-id="7311727822-2">[</span><span class="p" data-group-id="7311727822-3">{</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="7311727822-3">}</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7311727822-4">[</span><span class="ss">x</span><span class="p">,</span><span class="ss">y</span><span class="p" data-group-id="7311727822-4">]</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7311727822-5">[</span><span class="ss">a</span><span class="p">,</span><span class="ss">b</span><span class="p" data-group-id="7311727822-5">]</span><span class="p" data-group-id="7311727822-2">]</span><span class="p" data-group-id="7311727822-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="7311727822-6">(</span><span class="s">&quot;</span><span class="si">~s</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7311727822-7">[</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">info</span><span class="p" data-group-id="7311727822-8">(</span><span class="n">QH</span><span class="p">,</span><span class="w"> </span><span class="ss">unique_all</span><span class="p" data-group-id="7311727822-8">)</span><span class="p" data-group-id="7311727822-7">]</span><span class="p" data-group-id="7311727822-6">)</span><span class="p">.</span><span class="w">
</span><span class="k">begin</span><span class="w">
    </span><span class="n">V1</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="7311727822-9">(</span><span class="p" data-group-id="7311727822-10">[</span><span class="w">
               </span><span class="n">SQV</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">SQV</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7311727822-11">[</span><span class="ss">x</span><span class="p">,</span><span class="w"> </span><span class="ss">y</span><span class="p" data-group-id="7311727822-11">]</span><span class="w">
              </span><span class="p" data-group-id="7311727822-10">]</span><span class="p">,</span><span class="w">
              </span><span class="p" data-group-id="7311727822-12">[</span><span class="p" data-group-id="7311727822-13">{</span><span class="ss">unique</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="7311727822-13">}</span><span class="p" data-group-id="7311727822-12">]</span><span class="p" data-group-id="7311727822-9">)</span><span class="p">,</span><span class="w">
    </span><span class="n">V2</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="7311727822-14">(</span><span class="p" data-group-id="7311727822-15">[</span><span class="w">
               </span><span class="n">SQV</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">SQV</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="7311727822-16">[</span><span class="ss">a</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p" data-group-id="7311727822-16">]</span><span class="w">
              </span><span class="p" data-group-id="7311727822-15">]</span><span class="p">,</span><span class="w">
              </span><span class="p" data-group-id="7311727822-17">[</span><span class="p" data-group-id="7311727822-18">{</span><span class="ss">unique</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="7311727822-18">}</span><span class="p" data-group-id="7311727822-17">]</span><span class="p" data-group-id="7311727822-14">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="7311727822-19">(</span><span class="p" data-group-id="7311727822-20">[</span><span class="w">
           </span><span class="p" data-group-id="7311727822-21">{</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="7311727822-21">}</span><span class="w"> </span><span class="p">||</span><span class="w">
               </span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V1</span><span class="p">,</span><span class="w">
               </span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V2</span><span class="w">
          </span><span class="p" data-group-id="7311727822-20">]</span><span class="p">,</span><span class="w">
          </span><span class="p" data-group-id="7311727822-22">[</span><span class="p" data-group-id="7311727822-23">{</span><span class="ss">unique</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="7311727822-23">}</span><span class="p" data-group-id="7311727822-22">]</span><span class="p" data-group-id="7311727822-19">)</span><span class="w">
</span><span class="k">end</span></code></pre>
<p> In the following example QLC <code class="inline">V2</code> has been inserted to show the joined generators and the join method chosen. A convention is used for lookup join: the first generator (<code class="inline">G2</code>) is the one traversed, the second (<code class="inline">G1</code>) is the table where constants are looked up.</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">E1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">new</span><span class="p" data-group-id="3389133192-1">(</span><span class="ss">e1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3389133192-2">[</span><span class="p" data-group-id="3389133192-2">]</span><span class="p" data-group-id="3389133192-1">)</span><span class="p">,</span><span class="w">
</span><span class="n">E2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">new</span><span class="p" data-group-id="3389133192-3">(</span><span class="ss">e2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3389133192-4">[</span><span class="p" data-group-id="3389133192-4">]</span><span class="p" data-group-id="3389133192-3">)</span><span class="p">,</span><span class="w">
</span><span class="ss">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">insert</span><span class="p" data-group-id="3389133192-5">(</span><span class="n">E1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3389133192-6">[</span><span class="p" data-group-id="3389133192-7">{</span><span class="mi">1</span><span class="p">,</span><span class="ss">a</span><span class="p" data-group-id="3389133192-7">}</span><span class="p">,</span><span class="p" data-group-id="3389133192-8">{</span><span class="mi">2</span><span class="p">,</span><span class="ss">b</span><span class="p" data-group-id="3389133192-8">}</span><span class="p" data-group-id="3389133192-6">]</span><span class="p" data-group-id="3389133192-5">)</span><span class="p">,</span><span class="w">
</span><span class="ss">true</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">insert</span><span class="p" data-group-id="3389133192-9">(</span><span class="n">E2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3389133192-10">[</span><span class="p" data-group-id="3389133192-11">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="3389133192-11">}</span><span class="p">,</span><span class="p" data-group-id="3389133192-12">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="3389133192-12">}</span><span class="p" data-group-id="3389133192-10">]</span><span class="p" data-group-id="3389133192-9">)</span><span class="p">,</span><span class="w">
</span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="3389133192-13">(</span><span class="p" data-group-id="3389133192-14">[</span><span class="p" data-group-id="3389133192-15">{</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">W</span><span class="p" data-group-id="3389133192-15">}</span><span class="w"> </span><span class="p">||</span><span class="w">
</span><span class="p" data-group-id="3389133192-16">{</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p" data-group-id="3389133192-16">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="3389133192-17">(</span><span class="n">E1</span><span class="p" data-group-id="3389133192-17">)</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="3389133192-18">{</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="3389133192-18">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">ets</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="3389133192-19">(</span><span class="n">E2</span><span class="p" data-group-id="3389133192-19">)</span><span class="p">,</span><span class="w">
</span><span class="n">X</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="3389133192-14">]</span><span class="p" data-group-id="3389133192-13">)</span><span class="p">,</span><span class="w">
</span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="3389133192-20">(</span><span class="s">&quot;</span><span class="si">~s</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3389133192-21">[</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">info</span><span class="p" data-group-id="3389133192-22">(</span><span class="n">Q</span><span class="p" data-group-id="3389133192-22">)</span><span class="p" data-group-id="3389133192-21">]</span><span class="p" data-group-id="3389133192-20">)</span><span class="p">.</span><span class="w">
</span><span class="k">begin</span><span class="w">
    </span><span class="n">V1</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="3389133192-23">(</span><span class="p" data-group-id="3389133192-24">[</span><span class="w">
               </span><span class="n">P0</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">P0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3389133192-25">{</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="3389133192-25">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
                       </span><span class="nc">ets</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="3389133192-26">(</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.3098908599</span><span class="p">.</span><span class="mf">2283929601.256549</span><span class="o">&gt;</span><span class="p" data-group-id="3389133192-26">)</span><span class="w">
              </span><span class="p" data-group-id="3389133192-24">]</span><span class="p" data-group-id="3389133192-23">)</span><span class="p">,</span><span class="w">
    </span><span class="n">V2</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="3389133192-27">(</span><span class="p" data-group-id="3389133192-28">[</span><span class="w">
               </span><span class="p" data-group-id="3389133192-29">[</span><span class="n">G1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">G2</span><span class="p" data-group-id="3389133192-29">]</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">G2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V1</span><span class="p">,</span><span class="w">
                   </span><span class="n">G1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
                       </span><span class="nc">ets</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="3389133192-30">(</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.3098908599</span><span class="p">.</span><span class="mf">2283929601.256548</span><span class="o">&gt;</span><span class="p" data-group-id="3389133192-30">)</span><span class="p">,</span><span class="w">
                   </span><span class="nf">element</span><span class="p" data-group-id="3389133192-31">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">G1</span><span class="p" data-group-id="3389133192-31">)</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="nf">element</span><span class="p" data-group-id="3389133192-32">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">G2</span><span class="p" data-group-id="3389133192-32">)</span><span class="w">
              </span><span class="p" data-group-id="3389133192-28">]</span><span class="p">,</span><span class="w">
              </span><span class="p" data-group-id="3389133192-33">[</span><span class="p" data-group-id="3389133192-34">{</span><span class="ss">join</span><span class="p">,</span><span class="w"> </span><span class="ss">lookup</span><span class="p" data-group-id="3389133192-34">}</span><span class="p" data-group-id="3389133192-33">]</span><span class="p" data-group-id="3389133192-27">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="3389133192-35">(</span><span class="p" data-group-id="3389133192-36">[</span><span class="w">
           </span><span class="p" data-group-id="3389133192-37">{</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p" data-group-id="3389133192-37">}</span><span class="w"> </span><span class="p">||</span><span class="w">
               </span><span class="p" data-group-id="3389133192-38">[</span><span class="p" data-group-id="3389133192-39">{</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p" data-group-id="3389133192-39">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="3389133192-40">{</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="3389133192-40">}</span><span class="p" data-group-id="3389133192-38">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V2</span><span class="w">
          </span><span class="p" data-group-id="3389133192-36">]</span><span class="p" data-group-id="3389133192-35">)</span><span class="w">
</span><span class="k">end</span></code></pre>
  </section>
</section>
<section class="detail" id="keysortkeysort/23">
  <div class="detail-header">
    <a href="#keysortkeysort/23" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">keysortkeysort/23</h1>
  </div>
  <section class="docstring">
<p> Returns a query handle. When evaluating query handle <code class="inline">QH2</code>, the answers to query handle <code class="inline">QH1</code> are sorted by <code class="inline">file_sorter:keysort/4</code> according to the options.</p>
<p> The sorter uses temporary files only if <code class="inline">QH1</code> does not evaluate to a list and the size of the binary representation of the answers exceeds <code class="inline">Size</code> bytes, where <code class="inline">Size</code> is the value of option <code class="inline">size</code>.</p>
<p> <code class="inline">keysort(``KeyPos``, ``QH1``)</code> is equivalent to <code class="inline">keysort(``KeyPos``, ``QH1``, [])</code>.</p>
  </section>
</section>
<section class="detail" id="next_answersnext_answers/12">
  <div class="detail-header">
    <a href="#next_answersnext_answers/12" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">next_answersnext_answers/12</h1>
  </div>
  <section class="docstring">
<p> Returns some or all of the remaining answers to a query cursor. Only the owner of <code class="inline">QueryCursor</code> can retrieve answers.</p>
<p> Optional argument <code class="inline">NumberOfAnswers</code> determines the maximum number of answers returned. Defaults to <code class="inline">10</code>. If less than the requested number of answers is returned, subsequent calls to <code class="inline">next_answers</code> return <code class="inline">[]</code>.</p>
  </section>
</section>
<section class="detail" id="qq/12">
  <div class="detail-header">
    <a href="#qq/12" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">qq/12</h1>
  </div>
  <section class="docstring">
<p> Returns a query handle for a QLC. The QLC must be the first argument to this function, otherwise it is evaluated as an ordinary list comprehension. It is also necessary to add the following line to the source code:</p>
<pre><code class="nohighlight makeup erlang"><span class="p">-</span><span class="na">include_lib</span><span class="p" data-group-id="4414327391-1">(</span><span class="s">&quot;stdlib/include/qlc.hrl&quot;</span><span class="p" data-group-id="4414327391-1">)</span><span class="p">.</span></code></pre>
<p> This causes a parse transform to substitute a fun for the QLC. The (compiled) fun is called when the query handle is evaluated.</p>
<p> When calling <code class="inline">qlc:q/1,2</code> from the Erlang shell, the parse transform is automatically called. When this occurs, the fun substituted for the QLC is not compiled but is evaluated by <code class="inline">erl_eval(3)</code>. This is also true when expressions are evaluated by <code class="inline">file:eval/1,2</code> or in the debugger.</p>
<p> To be explicit, this does not work:</p>
<pre><code class="nohighlight makeup erlang"><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="3132929449-1">[</span><span class="n">X</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="3132929449-2">{</span><span class="n">X</span><span class="p" data-group-id="3132929449-2">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="3132929449-3">[</span><span class="p" data-group-id="3132929449-4">{</span><span class="mi">1</span><span class="p" data-group-id="3132929449-4">}</span><span class="p">,</span><span class="p" data-group-id="3132929449-5">{</span><span class="mi">2</span><span class="p" data-group-id="3132929449-5">}</span><span class="p" data-group-id="3132929449-3">]</span><span class="p" data-group-id="3132929449-1">]</span><span class="p">,</span><span class="w">
</span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="3132929449-6">(</span><span class="n">A</span><span class="p" data-group-id="3132929449-6">)</span><span class="p">,</span><span class="w">
</span><span class="p">.</span><span class="p">.</span><span class="p">.</span></code></pre>
<p> Variable <code class="inline">A</code> is bound to the evaluated value of the list comprehension (<code class="inline">[1,2]</code>). The compiler complains with an error message (&quot;argument is not a query list comprehension&quot;); the shell process stops with a <code class="inline">badarg</code> reason.</p>
<p> <code class="inline">q(``QLC``)</code> is equivalent to <code class="inline">q(``QLC``, [])</code>.</p>
<p> Options:</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="3938778028-1">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">ets</span><span class="p" data-group-id="3938778028-1">}</span><span class="err">`</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">cache</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="n">QLC</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">stored</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="n">ETS</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">each</span><span class="w"> </span><span class="ss">cached</span><span class="w"> </span><span class="n">QLC</span><span class="p">.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">cached</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">evaluated</span><span class="w"> </span><span class="ss">again</span><span class="p">,</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">fetched</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">without</span><span class="w"> </span><span class="ss">any</span><span class="w"> </span><span class="ss">further</span><span class="w"> </span><span class="ss">computations</span><span class="p">.</span><span class="w"> </span><span class="n">Therefore</span><span class="p">,</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">cached</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">have</span><span class="w"> </span><span class="ss">been</span><span class="w"> </span><span class="ss">found</span><span class="p">,</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="n">ETS</span><span class="w"> </span><span class="ss">tables</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">caching</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">qualifiers</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">emptied</span><span class="p">.</span><span class="w"> </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="ss">cache</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">equivalent</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="3938778028-2">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">ets</span><span class="p" data-group-id="3938778028-2">}</span><span class="err">`</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="3938778028-3">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">list</span><span class="p" data-group-id="3938778028-3">}</span><span class="err">`</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">cache</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">like</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="3938778028-4">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">ets</span><span class="p" data-group-id="3938778028-4">}</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">difference</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">kept</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="nf">list</span><span class="w"> </span><span class="p" data-group-id="3938778028-5">(</span><span class="ss">on</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">process</span><span class="w"> </span><span class="ss">heap</span><span class="p" data-group-id="3938778028-5">)</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">would</span><span class="w"> </span><span class="ss">occupy</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">than</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">certain</span><span class="w"> </span><span class="ss">amount</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">RAM</span><span class="w"> </span><span class="nb">memory</span><span class="p">,</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">temporary</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">storing</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="p">.</span><span class="w"> </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="ss">max_list_size</span><span class="err">`</span><span class="w"> </span><span class="ss">sets</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">limit</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">bytes</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">temporary</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="nb">put</span><span class="w"> </span><span class="ss">on</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">directory</span><span class="w"> </span><span class="ss">set</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="ss">tmpdir</span><span class="err">`</span><span class="p">.</span></code></pre>
<p> Option <code class="inline">cache</code> has no effect if it is known that the QLC is to be evaluated at most once. This is always true for the top-most QLC and also for the list expression of the first generator in a list of qualifiers. Notice that in the presence of side effects in filters or callback functions, the answers to QLCs can be affected by option <code class="inline">cache</code>.</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4523186789-1">{</span><span class="ss">unique</span><span class="p">,</span><span class="err"> </span><span class="ss">true</span><span class="p" data-group-id="4523186789-1">}</span><span class="err">`</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">remove</span><span class="w"> </span><span class="ss">duplicate</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="n">QLC</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">unique</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">stored</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="n">ETS</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">each</span><span class="w"> </span><span class="n">QLC</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">emptied</span><span class="w"> </span><span class="ss">every</span><span class="w"> </span><span class="ss">time</span><span class="w"> </span><span class="ss">it</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">known</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">there</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">no</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="n">QLC</span><span class="p">.</span><span class="w"> </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="ss">unique</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">equivalent</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4523186789-2">{</span><span class="ss">unique</span><span class="p">,</span><span class="err"> </span><span class="ss">true</span><span class="p" data-group-id="4523186789-2">}</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="ss">unique</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">combined</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4523186789-3">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">ets</span><span class="p" data-group-id="4523186789-3">}</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ss">two</span><span class="w"> </span><span class="n">ETS</span><span class="w"> </span><span class="ss">tables</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">used</span><span class="p">,</span><span class="w"> </span><span class="ss">but</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">full</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">stored</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">only</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="ss">unique</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">combined</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4523186789-4">{</span><span class="ss">cache</span><span class="p">,</span><span class="err"> </span><span class="ss">list</span><span class="p" data-group-id="4523186789-4">}</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">answers</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">sorted</span><span class="w"> </span><span class="ss">twice</span><span class="w"> </span><span class="ss">using</span><span class="w"> </span><span class="err">`</span><span class="ss">keysort</span><span class="o">/</span><span class="mi">3</span><span class="err">`</span><span class="p">;</span><span class="w"> </span><span class="ss">once</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">remove</span><span class="w"> </span><span class="ss">duplicates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">once</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">restore</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">order</span><span class="p">.</span></code></pre>
<p>   Options <code class="inline">cache</code> and <code class="inline">unique</code> apply not only to the QLC itself but also to the results of looking up constants, running match specifications, and joining handles.</p>
<p> Example:</p>
<p> In the following example the cached results of the merge join are traversed for each value of <code class="inline">A</code>. Notice that without option <code class="inline">cache</code> the join would have been carried out three times, once for each value of <code class="inline">A</code>.</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="1291431661-1">(</span><span class="p" data-group-id="1291431661-2">[</span><span class="p" data-group-id="1291431661-3">{</span><span class="n">A</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">W</span><span class="p" data-group-id="1291431661-3">}</span><span class="w"> </span><span class="p">||</span><span class="w">
</span><span class="n">A</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="1291431661-4">[</span><span class="ss">a</span><span class="p">,</span><span class="ss">b</span><span class="p">,</span><span class="ss">c</span><span class="p" data-group-id="1291431661-4">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="1291431661-5">{</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p" data-group-id="1291431661-5">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="1291431661-6">[</span><span class="p" data-group-id="1291431661-7">{</span><span class="ss">a</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="1291431661-7">}</span><span class="p">,</span><span class="p" data-group-id="1291431661-8">{</span><span class="ss">b</span><span class="p">,</span><span class="mi">4</span><span class="p" data-group-id="1291431661-8">}</span><span class="p">,</span><span class="p" data-group-id="1291431661-9">{</span><span class="ss">c</span><span class="p">,</span><span class="mi">6</span><span class="p" data-group-id="1291431661-9">}</span><span class="p" data-group-id="1291431661-6">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="1291431661-10">{</span><span class="n">W</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="1291431661-10">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="1291431661-11">[</span><span class="p" data-group-id="1291431661-12">{</span><span class="mi">2</span><span class="p">,</span><span class="ss">a</span><span class="p" data-group-id="1291431661-12">}</span><span class="p">,</span><span class="p" data-group-id="1291431661-13">{</span><span class="mi">3</span><span class="p">,</span><span class="ss">b</span><span class="p" data-group-id="1291431661-13">}</span><span class="p">,</span><span class="p" data-group-id="1291431661-14">{</span><span class="mi">4</span><span class="p">,</span><span class="ss">c</span><span class="p" data-group-id="1291431661-14">}</span><span class="p" data-group-id="1291431661-11">]</span><span class="p">,</span><span class="w">
</span><span class="n">X</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1291431661-2">]</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="1291431661-15">{</span><span class="ss">cache</span><span class="p">,</span><span class="w"> </span><span class="ss">list</span><span class="p" data-group-id="1291431661-15">}</span><span class="p" data-group-id="1291431661-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="1291431661-16">(</span><span class="s">&quot;</span><span class="si">~s</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-17">[</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">info</span><span class="p" data-group-id="1291431661-18">(</span><span class="n">Q</span><span class="p" data-group-id="1291431661-18">)</span><span class="p" data-group-id="1291431661-17">]</span><span class="p" data-group-id="1291431661-16">)</span><span class="p">.</span><span class="w">
</span><span class="k">begin</span><span class="w">
    </span><span class="n">V1</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="1291431661-19">(</span><span class="p" data-group-id="1291431661-20">[</span><span class="w">
               </span><span class="n">P0</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">P0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1291431661-21">{</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p" data-group-id="1291431661-21">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
                       </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">keysort</span><span class="p" data-group-id="1291431661-22">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-23">[</span><span class="p" data-group-id="1291431661-24">{</span><span class="ss">a</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="1291431661-24">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-25">{</span><span class="ss">b</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p" data-group-id="1291431661-25">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-26">{</span><span class="ss">c</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p" data-group-id="1291431661-26">}</span><span class="p" data-group-id="1291431661-23">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-27">[</span><span class="p" data-group-id="1291431661-27">]</span><span class="p" data-group-id="1291431661-22">)</span><span class="w">
              </span><span class="p" data-group-id="1291431661-20">]</span><span class="p" data-group-id="1291431661-19">)</span><span class="p">,</span><span class="w">
    </span><span class="n">V2</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="1291431661-28">(</span><span class="p" data-group-id="1291431661-29">[</span><span class="w">
               </span><span class="n">P0</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">P0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="1291431661-30">{</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1291431661-30">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
                       </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">keysort</span><span class="p" data-group-id="1291431661-31">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-32">[</span><span class="p" data-group-id="1291431661-33">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">a</span><span class="p" data-group-id="1291431661-33">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-34">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p" data-group-id="1291431661-34">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-35">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="ss">c</span><span class="p" data-group-id="1291431661-35">}</span><span class="p" data-group-id="1291431661-32">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-36">[</span><span class="p" data-group-id="1291431661-36">]</span><span class="p" data-group-id="1291431661-31">)</span><span class="w">
              </span><span class="p" data-group-id="1291431661-29">]</span><span class="p" data-group-id="1291431661-28">)</span><span class="p">,</span><span class="w">
    </span><span class="n">V3</span><span class="w"> </span><span class="o">=</span><span class="w">
        </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="1291431661-37">(</span><span class="p" data-group-id="1291431661-38">[</span><span class="w">
               </span><span class="p" data-group-id="1291431661-39">[</span><span class="n">G1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">G2</span><span class="p" data-group-id="1291431661-39">]</span><span class="w"> </span><span class="p">||</span><span class="w">
                   </span><span class="n">G1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V1</span><span class="p">,</span><span class="w">
                   </span><span class="n">G2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V2</span><span class="p">,</span><span class="w">
                   </span><span class="nf">element</span><span class="p" data-group-id="1291431661-40">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">G1</span><span class="p" data-group-id="1291431661-40">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">element</span><span class="p" data-group-id="1291431661-41">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">G2</span><span class="p" data-group-id="1291431661-41">)</span><span class="w">
              </span><span class="p" data-group-id="1291431661-38">]</span><span class="p">,</span><span class="w">
              </span><span class="p" data-group-id="1291431661-42">[</span><span class="p" data-group-id="1291431661-43">{</span><span class="ss">join</span><span class="p">,</span><span class="w"> </span><span class="ss">merge</span><span class="p" data-group-id="1291431661-43">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1291431661-44">{</span><span class="ss">cache</span><span class="p">,</span><span class="w"> </span><span class="ss">list</span><span class="p" data-group-id="1291431661-44">}</span><span class="p" data-group-id="1291431661-42">]</span><span class="p" data-group-id="1291431661-37">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="1291431661-45">(</span><span class="p" data-group-id="1291431661-46">[</span><span class="w">
           </span><span class="p" data-group-id="1291431661-47">{</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">,</span><span class="w"> </span><span class="n">W</span><span class="p" data-group-id="1291431661-47">}</span><span class="w"> </span><span class="p">||</span><span class="w">
               </span><span class="n">A</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="1291431661-48">[</span><span class="ss">a</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p">,</span><span class="w"> </span><span class="ss">c</span><span class="p" data-group-id="1291431661-48">]</span><span class="p">,</span><span class="w">
               </span><span class="p" data-group-id="1291431661-49">[</span><span class="p" data-group-id="1291431661-50">{</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p" data-group-id="1291431661-50">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="1291431661-51">{</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p" data-group-id="1291431661-51">}</span><span class="p" data-group-id="1291431661-49">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">V3</span><span class="p">,</span><span class="w">
               </span><span class="n">X</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="n">Y</span><span class="w">
          </span><span class="p" data-group-id="1291431661-46">]</span><span class="p" data-group-id="1291431661-45">)</span><span class="w">
</span><span class="k">end</span></code></pre>
<p> <code class="inline">sort/1,2</code> and <code class="inline">keysort/2,3</code> can also be used for caching answers and for removing duplicates. When sorting answers are cached in a list, possibly stored on a temporary file, and no ETS tables are used.</p>
<p> Sometimes (see <a href="#table/2"><code class="inline">table/2</code></a>) traversal of tables can be done by looking up key values, which is assumed to be fast. Under certain (rare) circumstances there can be too many key values to look up.  Option <code class="inline">{max_lookup, MaxLookup}</code> can then be used to limit the number of lookups: if more than <code class="inline">MaxLookup</code> lookups would be required, no lookups are done but the table is traversed instead. Defaults to <code class="inline">infinity</code>, which means that there is no limit on the number of keys to look up.</p>
<p> Example:</p>
<p> In the following example, using the <code class="inline">gb_table</code> module from section Implementing a QLC Table, there are six keys to look up: <code class="inline">{1,a}</code>, <code class="inline">{1,b}</code>, <code class="inline">{1,c}</code>, <code class="inline">{2,a}</code>, <code class="inline">{2,b}</code>, and <code class="inline">{2,c}</code>. The reason is that the two elements of key <code class="inline">{X, Y}</code> are compared separately.</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gb_trees</span><span class="p">:</span><span class="nf">empty</span><span class="p" data-group-id="9933741546-1">(</span><span class="p" data-group-id="9933741546-1">)</span><span class="p">,</span><span class="w">
</span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">q</span><span class="p" data-group-id="9933741546-2">(</span><span class="p" data-group-id="9933741546-3">[</span><span class="n">X</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="9933741546-4">{</span><span class="p" data-group-id="9933741546-5">{</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p" data-group-id="9933741546-5">}</span><span class="p">,</span><span class="p">_</span><span class="p" data-group-id="9933741546-4">}</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nc">gb_table</span><span class="p">:</span><span class="nf">table</span><span class="p" data-group-id="9933741546-6">(</span><span class="n">T</span><span class="p" data-group-id="9933741546-6">)</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="9933741546-7">(</span><span class="p" data-group-id="9933741546-8">(</span><span class="n">X</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="9933741546-8">)</span><span class="w"> </span><span class="nf">or</span><span class="w"> </span><span class="p" data-group-id="9933741546-9">(</span><span class="n">X</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="9933741546-9">)</span><span class="p" data-group-id="9933741546-7">)</span><span class="w"> </span><span class="nf">andalso</span><span class="w">
</span><span class="p" data-group-id="9933741546-10">(</span><span class="p" data-group-id="9933741546-11">(</span><span class="n">Y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">a</span><span class="p" data-group-id="9933741546-11">)</span><span class="w"> </span><span class="nf">or</span><span class="w"> </span><span class="p" data-group-id="9933741546-12">(</span><span class="n">Y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">b</span><span class="p" data-group-id="9933741546-12">)</span><span class="w"> </span><span class="nf">or</span><span class="w"> </span><span class="p" data-group-id="9933741546-13">(</span><span class="n">Y</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">c</span><span class="p" data-group-id="9933741546-13">)</span><span class="p" data-group-id="9933741546-10">)</span><span class="p" data-group-id="9933741546-3">]</span><span class="p" data-group-id="9933741546-2">)</span><span class="p">,</span><span class="w">
</span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="9933741546-14">(</span><span class="s">&quot;</span><span class="si">~s</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9933741546-15">[</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">info</span><span class="p" data-group-id="9933741546-16">(</span><span class="n">QH</span><span class="p" data-group-id="9933741546-16">)</span><span class="p" data-group-id="9933741546-15">]</span><span class="p" data-group-id="9933741546-14">)</span><span class="p">.</span><span class="w">
</span><span class="nc">ets</span><span class="p">:</span><span class="nf">match_spec_run</span><span class="p" data-group-id="9933741546-17">(</span><span class="w">
       </span><span class="nc">lists</span><span class="p">:</span><span class="nf">flatmap</span><span class="p" data-group-id="9933741546-18">(</span><span class="nf">fun</span><span class="p" data-group-id="9933741546-19">(</span><span class="n">K</span><span class="p" data-group-id="9933741546-19">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                            </span><span class="k">case</span><span class="w">
                                </span><span class="nc">gb_trees</span><span class="p">:</span><span class="nf">lookup</span><span class="p" data-group-id="9933741546-20">(</span><span class="n">K</span><span class="p">,</span><span class="w">
                                                </span><span class="nc">gb_trees</span><span class="p">:</span><span class="nf">from_orddict</span><span class="p" data-group-id="9933741546-21">(</span><span class="p" data-group-id="9933741546-22">[</span><span class="p" data-group-id="9933741546-22">]</span><span class="p" data-group-id="9933741546-21">)</span><span class="p" data-group-id="9933741546-20">)</span><span class="w">
                            </span><span class="k">of</span><span class="w">
                                </span><span class="p" data-group-id="9933741546-23">{</span><span class="ss">value</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p" data-group-id="9933741546-23">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                                    </span><span class="p" data-group-id="9933741546-24">[</span><span class="p" data-group-id="9933741546-25">{</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p" data-group-id="9933741546-25">}</span><span class="p" data-group-id="9933741546-24">]</span><span class="p">;</span><span class="w">
                                </span><span class="ss">none</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                                    </span><span class="p" data-group-id="9933741546-26">[</span><span class="p" data-group-id="9933741546-26">]</span><span class="w">
                            </span><span class="k">end</span><span class="w">
                     </span><span class="k">end</span><span class="p">,</span><span class="w">
                     </span><span class="p" data-group-id="9933741546-27">[</span><span class="p" data-group-id="9933741546-28">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">a</span><span class="p" data-group-id="9933741546-28">}</span><span class="p">,</span><span class="w">
                      </span><span class="p" data-group-id="9933741546-29">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p" data-group-id="9933741546-29">}</span><span class="p">,</span><span class="w">
                      </span><span class="p" data-group-id="9933741546-30">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">c</span><span class="p" data-group-id="9933741546-30">}</span><span class="p">,</span><span class="w">
                      </span><span class="p" data-group-id="9933741546-31">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">a</span><span class="p" data-group-id="9933741546-31">}</span><span class="p">,</span><span class="w">
                      </span><span class="p" data-group-id="9933741546-32">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">b</span><span class="p" data-group-id="9933741546-32">}</span><span class="p">,</span><span class="w">
                      </span><span class="p" data-group-id="9933741546-33">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">c</span><span class="p" data-group-id="9933741546-33">}</span><span class="p" data-group-id="9933741546-27">]</span><span class="p" data-group-id="9933741546-18">)</span><span class="p">,</span><span class="w">
       </span><span class="nc">ets</span><span class="p">:</span><span class="nf">match_spec_compile</span><span class="p" data-group-id="9933741546-34">(</span><span class="p" data-group-id="9933741546-35">[</span><span class="p" data-group-id="9933741546-36">{</span><span class="p" data-group-id="9933741546-37">{</span><span class="p" data-group-id="9933741546-38">{</span><span class="ss">&#39;$1&#39;</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;$2&#39;</span><span class="p" data-group-id="9933741546-38">}</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;_&#39;</span><span class="p" data-group-id="9933741546-37">}</span><span class="p">,</span><span class="w">
                                </span><span class="p" data-group-id="9933741546-39">[</span><span class="p" data-group-id="9933741546-39">]</span><span class="p">,</span><span class="w">
                                </span><span class="p" data-group-id="9933741546-40">[</span><span class="ss">&#39;$1&#39;</span><span class="p" data-group-id="9933741546-40">]</span><span class="p" data-group-id="9933741546-36">}</span><span class="p" data-group-id="9933741546-35">]</span><span class="p" data-group-id="9933741546-34">)</span><span class="p" data-group-id="9933741546-17">)</span></code></pre>
<p> Options:</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4757190746-1">{</span><span class="ss">lookup</span><span class="p">,</span><span class="err"> </span><span class="ss">true</span><span class="p" data-group-id="4757190746-1">}</span><span class="err">`</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">ensure</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="err">`</span><span class="ss">qlc</span><span class="err">`</span><span class="w"> </span><span class="ss">module</span><span class="w"> </span><span class="ss">looks</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="ss">constants</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">some</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">there</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">than</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">among</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">list</span><span class="w"> </span><span class="ss">expressions</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">generators</span><span class="p">,</span><span class="w"> </span><span class="ss">constants</span><span class="w"> </span><span class="ss">must</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">looked</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">at</span><span class="w"> </span><span class="ss">least</span><span class="w"> </span><span class="ss">one</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">tables</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">evaluation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">fails</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">there</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">no</span><span class="w"> </span><span class="ss">constants</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">look</span><span class="w"> </span><span class="ss">up</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">useful</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="ss">it</span><span class="w"> </span><span class="ss">would</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">unacceptable</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">traverse</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">some</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="n">Setting</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="ss">lookup</span><span class="err">`</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="ss">false</span><span class="err">`</span><span class="w"> </span><span class="ss">ensures</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">no</span><span class="w"> </span><span class="ss">constants</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">looked</span><span class="w"> </span><span class="nf">up</span><span class="w"> </span><span class="p" data-group-id="4757190746-2">(</span><span class="err">`</span><span class="p" data-group-id="4757190746-3">{</span><span class="ss">max_lookup</span><span class="p">,</span><span class="err"> </span><span class="mi">0</span><span class="p" data-group-id="4757190746-3">}</span><span class="err">`</span><span class="w"> </span><span class="ss">has</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">same</span><span class="w"> </span><span class="ss">effect</span><span class="p" data-group-id="4757190746-2">)</span><span class="p">.</span><span class="w"> </span><span class="n">Defaults</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="ss">any</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ss">which</span><span class="w"> </span><span class="ss">means</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">constants</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">looked</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="ss">whenever</span><span class="w"> </span><span class="ss">possible</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">Option</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4757190746-4">{</span><span class="ss">join</span><span class="p">,</span><span class="err"> </span><span class="n">Join</span><span class="p" data-group-id="4757190746-4">}</span><span class="err">`</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">ensure</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">certain</span><span class="w"> </span><span class="ss">join</span><span class="w"> </span><span class="ss">method</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="nc">used</span><span class="p">:</span><span class="w">

</span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4757190746-5">{</span><span class="ss">join</span><span class="p">,</span><span class="err"> </span><span class="ss">lookup</span><span class="p" data-group-id="4757190746-5">}</span><span class="err">`</span><span class="w"> </span><span class="ss">invokes</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">lookup</span><span class="w"> </span><span class="ss">join</span><span class="w"> </span><span class="ss">method</span><span class="p">.</span><span class="w">   </span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4757190746-6">{</span><span class="ss">join</span><span class="p">,</span><span class="err"> </span><span class="ss">merge</span><span class="p" data-group-id="4757190746-6">}</span><span class="err">`</span><span class="w"> </span><span class="ss">invokes</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">merge</span><span class="w"> </span><span class="ss">join</span><span class="w"> </span><span class="ss">method</span><span class="p">.</span><span class="w">   </span><span class="o">*</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="4757190746-7">{</span><span class="ss">join</span><span class="p">,</span><span class="err"> </span><span class="ss">nested_loop</span><span class="p" data-group-id="4757190746-7">}</span><span class="err">`</span><span class="w"> </span><span class="ss">invokes</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">method</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">matching</span><span class="w"> </span><span class="ss">every</span><span class="w"> </span><span class="ss">pair</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="ss">two</span><span class="w"> </span><span class="ss">handles</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="ss">method</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">mostly</span><span class="w"> </span><span class="ss">very</span><span class="w"> </span><span class="ss">slow</span><span class="p">.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">evaluation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">fails</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="err">`</span><span class="ss">qlc</span><span class="err">`</span><span class="w"> </span><span class="ss">module</span><span class="w"> </span><span class="ss">cannot</span><span class="w"> </span><span class="ss">carry</span><span class="w"> </span><span class="ss">out</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">chosen</span><span class="w"> </span><span class="ss">join</span><span class="w"> </span><span class="ss">method</span><span class="p">.</span><span class="w"> </span><span class="n">Defaults</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="ss">any</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ss">which</span><span class="w"> </span><span class="ss">means</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">some</span><span class="w"> </span><span class="ss">fast</span><span class="w"> </span><span class="ss">join</span><span class="w"> </span><span class="ss">method</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">possible</span><span class="p">.</span></code></pre>
  </section>
</section>
<section class="detail" id="sortsort/12">
  <div class="detail-header">
    <a href="#sortsort/12" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">sortsort/12</h1>
  </div>
  <section class="docstring">
<p> Returns a query handle. When evaluating query handle <code class="inline">QH2</code>, the answers to query handle <code class="inline">QH1</code> are sorted by <code class="inline">file_sorter:sort/3</code> according to the options.</p>
<p> The sorter uses temporary files only if <code class="inline">QH1</code> does not evaluate to a list and the size of the binary representation of the answers exceeds <code class="inline">Size</code> bytes, where <code class="inline">Size</code> is the value of option <code class="inline">size</code>.</p>
<p> <code class="inline">sort(``QH1``)</code> is equivalent to <code class="inline">sort(``QH1``, [])</code>.</p>
  </section>
</section>
<section class="detail" id="string_to_handlestring_to_handlestring_to_handle/123">
  <div class="detail-header">
    <a href="#string_to_handlestring_to_handlestring_to_handle/123" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">string_to_handlestring_to_handlestring_to_handle/123</h1>
  </div>
  <section class="docstring">
<p> A string version of <code class="inline">q/1,2</code>. When the query handle is evaluated, the fun created by the parse transform is interpreted by <code class="inline">erl_eval(3)</code>. The query string is to be one single QLC terminated by a period.</p>
<p> Example:</p>
<pre><code class="nohighlight makeup erlang"><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="2871375853-1">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p" data-group-id="2871375853-1">]</span><span class="p">,</span><span class="w">
</span><span class="n">Bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">erl_eval</span><span class="p">:</span><span class="nf">add_binding</span><span class="p" data-group-id="2871375853-2">(</span><span class="ss">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="nc">erl_eval</span><span class="p">:</span><span class="nf">new_bindings</span><span class="p" data-group-id="2871375853-3">(</span><span class="p" data-group-id="2871375853-3">)</span><span class="p" data-group-id="2871375853-2">)</span><span class="p">,</span><span class="w">
</span><span class="n">QH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">qlc</span><span class="p">:</span><span class="nf">string_to_handle</span><span class="p" data-group-id="2871375853-4">(</span><span class="s">&quot;[X+1 || X &lt;- L].&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2871375853-5">[</span><span class="p" data-group-id="2871375853-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">Bs</span><span class="p" data-group-id="2871375853-4">)</span><span class="p">,</span><span class="w">
</span><span class="nc">qlc</span><span class="p">:</span><span class="nf">eval</span><span class="p" data-group-id="2871375853-6">(</span><span class="n">QH</span><span class="p" data-group-id="2871375853-6">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="2871375853-7">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p" data-group-id="2871375853-7">]</span></code></pre>
<p> <code class="inline">string_to_handle(``QueryString``)</code> is equivalent to <code class="inline">string_to_handle(``QueryString``, [])</code>.</p>
<p> <code class="inline">string_to_handle(``QueryString``, ``Options``)</code> is equivalent to <code class="inline">string_to_handle(``QueryString``, ``Options``, erl_eval:new_bindings())</code>.</p>
<p> This function is probably mainly useful when called from outside of Erlang, for example from a driver written in C.</p>
  </section>
</section>
<section class="detail" id="table/2">
  <div class="detail-header">
    <a href="#table/2" class="detail-link" title="Link to this function">
      <span class="icon-link" aria-hidden="true"></span>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature">table/2</h1>
      <div class="specs">
          <pre>table(traverseFun, options) :: qH
when traverseFun: traverseFun0 | traverseFun1,
     traverseFun0: (() -> traverseResult),
     traverseFun1: (match_expression() -> traverseResult),
     traverseResult: objects | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
     objects: [] | [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>() | objectList],
     objectList: traverseFun0 | objects,
     options: [option] | option,
     option:
       {:format_fun, formatFun}
       | {:info_fun, infoFun}
       | {:lookup_fun, lookupFun}
       | {:parent_fun, parentFun}
       | {:post_fun, postFun}
       | {:pre_fun, preFun}
       | {:key_equality, keyComparison},
     formatFun: :undefined | (selectedObjects -> formatedTable),
     selectedObjects:
       :all
       | {:all, nElements, depthFun}
       | {:match_spec, match_expression()}
       | {:lookup, position, keys}
       | {:lookup, position, keys, nElements, depthFun},
     nElements: :infinity | <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pos_integer</a>(),
     depthFun: (<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>() -> <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()),
     formatedTable: {mod, fun, args} | abstract_expr() | string(),
     infoFun: :undefined | (infoTag -> infoValue),
     infoTag: :indices | :is_unique_objects | :keypos | :num_of_objects,
     infoValue: :undefined | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
     lookupFun: :undefined | (position, keys -> lookupResult),
     lookupResult: [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()] | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
     parentFun: :undefined | (() -> parentFunValue),
     postFun: :undefined | (() -> <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()),
     preFun: :undefined | (preArgs -> <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()),
     preArgs: [preArg],
     preArg: {:parent_value, parentFunValue} | {:stop_fun, stopFun},
     parentFunValue: :undefined | <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>(),
     stopFun: :undefined | (() -> <a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()),
     keyComparison: :"=:=" | :==,
     position: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">pos_integer</a>(),
     keys: [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()],
     mod: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(),
     fun: <a href="https://hexdocs.pm/elixir/typespecs.html#basic-types">atom</a>(),
     args: [<a href="https://hexdocs.pm/elixir/typespecs.html#built-in-types">term</a>()],
     qH: query_handle()</pre>
      </div>
  </div>
  <section class="docstring">
<p> Returns a query handle for a QLC table. In Erlang/OTP there is support for ETS, Dets, and Mnesia tables, but many other data structures can be turned into QLC tables. This is accomplished by letting function(s) in the module implementing the data structure create a query handle by calling <code class="inline">qlc:table/2</code>. The different ways to traverse the table and properties of the table are handled by callback functions provided as options to <code class="inline">qlc:table/2</code>.</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Callback</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="err">`</span><span class="n">TraverseFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">traversing</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="ss">terminated</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="ss">either</span><span class="w"> </span><span class="err">`</span><span class="p" data-group-id="5693241102-1">[</span><span class="p" data-group-id="5693241102-1">]</span><span class="err">`</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">nullary</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">traversing</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ss">yet</span><span class="w"> </span><span class="ss">traversed</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="n">Any</span><span class="w"> </span><span class="ss">other</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">immediately</span><span class="w"> </span><span class="ss">returned</span><span class="w"> </span><span class="ss">as</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">evaluation</span><span class="p">.</span><span class="w"> </span><span class="n">Unary</span><span class="w"> </span><span class="err">`</span><span class="n">TraverseFun</span><span class="err">`</span><span class="ss">s</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">accept</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specification</span><span class="w"> </span><span class="ss">as</span><span class="w"> </span><span class="ss">argument</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specification</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">created</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">parse</span><span class="w"> </span><span class="ss">transform</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="ss">analyzing</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">pattern</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">generator</span><span class="w"> </span><span class="ss">calling</span><span class="w"> </span><span class="err">`</span><span class="nc">qlc</span><span class="p">:</span><span class="ss">table</span><span class="o">/</span><span class="mi">2</span><span class="err">`</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">filters</span><span class="w"> </span><span class="ss">using</span><span class="w"> </span><span class="ss">variables</span><span class="w"> </span><span class="ss">introduced</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">pattern</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">parse</span><span class="w"> </span><span class="ss">transform</span><span class="w"> </span><span class="ss">cannot</span><span class="w"> </span><span class="ss">find</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specification</span><span class="w"> </span><span class="ss">equivalent</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">pattern</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">filters</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="n">TraverseFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specification</span><span class="w"> </span><span class="ss">returning</span><span class="w"> </span><span class="ss">every</span><span class="w"> </span><span class="ss">object</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">Modules</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">use</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ss">specifications</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">optimized</span><span class="w"> </span><span class="ss">traversal</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">tables</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">call</span><span class="w"> </span><span class="err">`</span><span class="nc">qlc</span><span class="p">:</span><span class="ss">table</span><span class="o">/</span><span class="mi">2</span><span class="err">`</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="ss">an</span><span class="w"> </span><span class="ss">unary</span><span class="w"> </span><span class="err">`</span><span class="n">TraverseFun</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="n">An</span><span class="w"> </span><span class="ss">example</span><span class="w"> </span><span class="ss">is</span><span class="w">  </span><span class="err">`</span><span class="nc">ets</span><span class="p">:</span><span class="ss">table</span><span class="o">/</span><span class="mi">2</span><span class="err">`</span><span class="p">.</span><span class="w">

</span><span class="o">*</span><span class="w">  </span><span class="n">Other</span><span class="w"> </span><span class="ss">modules</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">provide</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">nullary</span><span class="w"> </span><span class="err">`</span><span class="n">TraverseFun</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="n">An</span><span class="w"> </span><span class="ss">example</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="err">`</span><span class="nc">gb_table</span><span class="p">:</span><span class="ss">table</span><span class="o">/</span><span class="mi">1</span><span class="err">`</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">section</span><span class="w"> </span><span class="n">Implementing</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="n">QLC</span><span class="w"> </span><span class="n">Table</span><span class="p">.</span><span class="w">

  </span><span class="o">*</span><span class="w">  </span><span class="n">Unary</span><span class="w"> </span><span class="ss">callback</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="err">`</span><span class="n">PreFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">once</span><span class="w"> </span><span class="ss">before</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">read</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">first</span><span class="w"> </span><span class="ss">time</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">call</span><span class="w"> </span><span class="ss">fails</span><span class="p">,</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">evaluation</span><span class="w"> </span><span class="ss">fails</span><span class="p">.</span></code></pre>
<p> Argument <code class="inline">PreArgs</code> is a list of tagged values. There are two tags, <code class="inline">parent_value</code> and <code class="inline">stop_fun</code>, used by Mnesia for managing transactions.</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="ss">parent_value</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="ss">returned</span><span class="w"> </span><span class="ss">by</span><span class="w"> </span><span class="err">`</span><span class="n">ParentFun</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="ss">undefined</span><span class="err">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">there</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">no</span><span class="w"> </span><span class="err">`</span><span class="n">ParentFun</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="err">`</span><span class="n">ParentFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">once</span><span class="w"> </span><span class="ss">just</span><span class="w"> </span><span class="ss">before</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">call</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="n">PreFun</span><span class="err">`</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">context</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">process</span><span class="w"> </span><span class="ss">calling</span><span class="w"> </span><span class="err">`</span><span class="ss">eval</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="ss">fold</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="ss">cursor</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="err">`</span><span class="p">.</span><span class="w"> 

</span><span class="o">*</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="ss">stop_fun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">nullary</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">deletes</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">cursor</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">from</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">parent</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">`</span><span class="ss">undefined</span><span class="err">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">there</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">no</span><span class="w"> </span><span class="ss">cursor</span><span class="p">.</span><span class="w">

  </span><span class="o">*</span><span class="w">  </span><span class="n">Nullary</span><span class="w"> </span><span class="ss">callback</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="err">`</span><span class="n">PostFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">once</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">was</span><span class="w"> </span><span class="ss">last</span><span class="w"> </span><span class="ss">read</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">value</span><span class="p">,</span><span class="w"> </span><span class="ss">which</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">caught</span><span class="p">,</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">ignored</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="err">`</span><span class="n">PreFun</span><span class="err">`</span><span class="w"> </span><span class="ss">has</span><span class="w"> </span><span class="ss">been</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">table</span><span class="p">,</span><span class="w"> </span><span class="err">`</span><span class="n">PostFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">guaranteed</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">table</span><span class="p">,</span><span class="w"> </span><span class="ss">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">evaluation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">fails</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">some</span><span class="w"> </span><span class="ss">reason</span><span class="p">.</span></code></pre>
<p> The pre (post) functions for different tables are evaluated in unspecified order.</p>
<p> Other table access than reading, such as calling <code class="inline">InfoFun</code>, is assumed to be OK at any time.</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Binary</span><span class="w"> </span><span class="ss">callback</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="err">`</span><span class="n">LookupFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">used</span><span class="w"> </span><span class="ss">for</span><span class="w"> </span><span class="ss">looking</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="ss">objects</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">first</span><span class="w"> </span><span class="ss">argument</span><span class="w"> </span><span class="err">`</span><span class="n">Position</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">key</span><span class="w"> </span><span class="ss">position</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">an</span><span class="w"> </span><span class="ss">indexed</span><span class="w"> </span><span class="ss">position</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">second</span><span class="w"> </span><span class="ss">argument</span><span class="w"> </span><span class="err">`</span><span class="n">Keys</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">sorted</span><span class="w"> </span><span class="ss">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">unique</span><span class="w"> </span><span class="ss">values</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">list</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="nf">objects</span><span class="w"> </span><span class="p" data-group-id="3619768111-1">(</span><span class="ss">tuples</span><span class="p" data-group-id="3619768111-1">)</span><span class="p">,</span><span class="w"> </span><span class="ss">such</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="nb">element</span><span class="w"> </span><span class="ss">at</span><span class="w"> </span><span class="err">`</span><span class="n">Position</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">member</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="err">`</span><span class="n">Keys</span><span class="err">`</span><span class="p">.</span><span class="w"> </span><span class="n">Any</span><span class="w"> </span><span class="ss">other</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">immediately</span><span class="w"> </span><span class="ss">returned</span><span class="w"> </span><span class="ss">as</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="k">query</span><span class="w"> </span><span class="ss">evaluation</span><span class="p">.</span><span class="w"> </span><span class="err">`</span><span class="n">LookupFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">called</span><span class="w"> </span><span class="ss">instead</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">traversing</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">parse</span><span class="w"> </span><span class="ss">transform</span><span class="w"> </span><span class="ss">at</span><span class="w"> </span><span class="ss">compile</span><span class="w"> </span><span class="ss">time</span><span class="w"> </span><span class="ss">can</span><span class="w"> </span><span class="ss">determine</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">filters</span><span class="w"> </span><span class="ss">match</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">compare</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="nb">element</span><span class="w"> </span><span class="ss">at</span><span class="w"> </span><span class="err">`</span><span class="n">Position</span><span class="err">`</span><span class="w"> </span><span class="ss">in</span><span class="w"> </span><span class="ss">such</span><span class="w"> </span><span class="ss">a</span><span class="w"> </span><span class="ss">way</span><span class="w"> </span><span class="ss">that</span><span class="w"> </span><span class="ss">only</span><span class="w"> </span><span class="err">`</span><span class="n">Keys</span><span class="err">`</span><span class="w"> </span><span class="ss">need</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">looked</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">find</span><span class="w"> </span><span class="ss">all</span><span class="w"> </span><span class="ss">potential</span><span class="w"> </span><span class="ss">answers</span><span class="p">.</span></code></pre>
<p> The key position is obtained by calling <code class="inline">InfoFun``(keypos)</code> and the indexed positions by calling <code class="inline">InfoFun``(indices)</code>. If the key position can be used for lookup, it is always chosen, otherwise the indexed position requiring the least number of lookups is chosen. If there is a tie between two indexed positions, the one occurring first in the list returned by <code class="inline">InfoFun</code> is chosen. Positions requiring more than max_lookup lookups are ignored.</p>
<pre><code class="nohighlight makeup erlang"><span class="o">*</span><span class="w">  </span><span class="n">Unary</span><span class="w"> </span><span class="ss">callback</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="err">`</span><span class="n">InfoFun</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">return</span><span class="w"> </span><span class="ss">information</span><span class="w"> </span><span class="ss">about</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="p">.</span><span class="w"> </span><span class="err">`</span><span class="ss">undefined</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="ss">returned</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">some</span><span class="w"> </span><span class="ss">tag</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="nc">unknown</span><span class="p">:</span></code></pre>
<p>  <code class="inline">indices</code>   <em> Returns a list of indexed positions, a list of positive integers. <code class="inline">is_unique_objects</code>   </em> Returns <code class="inline">true</code> if the objects returned by <code class="inline">TraverseFun</code> are unique.  <code class="inline">keypos</code>   <em> Returns the position of the table key, a positive integer.  <code class="inline">is_sorted_key</code>   </em> Returns <code class="inline">true</code> if the objects returned by <code class="inline">TraverseFun</code> are sorted on the key.  <code class="inline">num_of_objects</code>   <em> Returns the number of objects in the table, a non-negative integer.      </em>  Unary callback function <code class="inline">FormatFun</code> is used by <code class="inline">info/1,2</code> for displaying the call that created the query handle of the table. Defaults to <code class="inline">undefined</code>, which means that <code class="inline">info/1,2</code> displays a call to <code class="inline">&#39;$MOD&#39;:&#39;$FUN&#39;/0</code>. It is up to <code class="inline">FormatFun</code> to present the selected objects of the table in a suitable way. However, if a character list is chosen for presentation, it must be an Erlang expression that can be scanned and parsed (a trailing dot is added by <code class="inline">info/1,2</code> though).</p>
<p> <code class="inline">FormatFun</code> is called with an argument that describes the selected objects based on optimizations done as a result of analyzing the filters of the QLC where the call to <code class="inline">qlc:table/2</code> occurs. The argument can have the following values:</p>
<p>  <code class="inline">{lookup, Position, Keys, NElements, DepthFun}</code>.   *  <code class="inline">LookupFun</code> is used for looking up objects in the table.</p>
<p>  <code class="inline">{match_spec, MatchExpression}</code>   *  No way of finding all possible answers by looking up keys was found, but the filters could be transformed into a match specification. All answers are found by calling <code class="inline">TraverseFun(MatchExpression)</code>.</p>
<p>  <code class="inline">{all, NElements, DepthFun}</code>   *  No optimization was found. A match specification matching all objects is used if <code class="inline">TraverseFun</code> is unary.</p>
<p> <code class="inline">NElements</code> is the value of the <code class="inline">info/1,2</code> option <code class="inline">n_elements</code>.</p>
<p> <code class="inline">DepthFun</code> is a function that can be used for limiting the size of terms; calling <code class="inline">DepthFun(Term)</code> substitutes <code class="inline">&#39;...&#39;</code> for parts of <code class="inline">Term</code> below the depth specified by the <code class="inline">info/1,2</code> option <code class="inline">depth</code>.</p>
<p> If calling <code class="inline">FormatFun</code> with an argument including <code class="inline">NElements</code> and <code class="inline">DepthFun</code> fails, <code class="inline">FormatFun</code> is called once again with an argument excluding <code class="inline">NElements</code> and <code class="inline">DepthFun</code> (<code class="inline">{lookup, Position, Keys}</code> or <code class="inline">all</code>).</p>
<pre><code class="nohighlight makeup erlang"><span class="w">  </span><span class="o">*</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="ss">value</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="ss">option</span><span class="w"> </span><span class="err">`</span><span class="ss">key_equality</span><span class="err">`</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="err">`</span><span class="ss">&#39;=:=&#39;</span><span class="err">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">table</span><span class="w"> </span><span class="ss">considers</span><span class="w"> </span><span class="ss">two</span><span class="w"> </span><span class="ss">keys</span><span class="w"> </span><span class="ss">equal</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">they</span><span class="w"> </span><span class="ss">match</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="ss">be</span><span class="w"> </span><span class="err">`</span><span class="ss">&#39;==&#39;</span><span class="err">`</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">two</span><span class="w"> </span><span class="ss">keys</span><span class="w"> </span><span class="ss">are</span><span class="w"> </span><span class="ss">equal</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ss">they</span><span class="w"> </span><span class="ss">compare</span><span class="w"> </span><span class="ss">equal</span><span class="p">.</span><span class="w"> </span><span class="n">Defaults</span><span class="w"> </span><span class="ss">to</span><span class="w"> </span><span class="err">`</span><span class="ss">&#39;=:=&#39;</span><span class="err">`</span><span class="p">.</span></code></pre>
<p>   For the various options recognized by <code class="inline">table/1,2</code> in respective module, see <code class="inline">ets(3)</code>, <code class="inline">dets(3)</code>, and <code class="inline">mnesia(3)</code>. </p>
  </section>
</section>
          </div>
        </section>
      <footer class="footer">
        <p>
          <span class="line">
            Built using
            <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener">ExDoc</a> (v0.21.2),
          </span>
          <span class="line">
            designed by
            <a href="https://twitter.com/dignifiedquire" target="_blank" rel="noopener" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
        </p>
        <p>
          <button class="line footer-button night-mode-toggle">
            Toggle night mode
          </button>
          <button class="line footer-button tooltips-toggle">
            <span class="tooltips-option-disable">Disable tooltips</span>
            <span class="tooltips-option-enable">Enable tooltips</span>
          </button>
          <button class="line footer-button display-shortcuts-help">
            Display keyboard shortcuts
          </button>
          <button class="line footer-button display-quick-switch">
            Go to a HexDocs package
          </button>
        </p>
      </footer>
    </div>
  </div>
</section>
</div>
  </body>
</html>
